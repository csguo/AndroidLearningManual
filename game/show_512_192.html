
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML xmlns="http://www.w3.org/1999/xhtml">
<HEAD>
<TITLE>【Android2D游戏开发十二】详解SharedPreference,FIle将数据存到SD卡_Android学习手册</TITLE>
<META content="text/html; charset=gb2312" http-equiv=Content-Type><LINK  rel=stylesheet type=text/css href="../css/c5.css">
<META name=GENERATOR content="MSHTML 8.00.6001.18702">
<meta name="Description" content=Android基础 Android组件 Android用户界面 Android设备功能 Android数据存储 Android网络应用 Android游戏开发 Android多媒体 Android源码开发 Android高级进阶 Android面试题/>
<meta name="Keywords" content="android 学习手册">

</HEAD>
<BODY id=homesecond class=serverscripting>
<DIV id=wrapper>
<DIV id=header><h1><a href="../index.html">Android学习手册</a></h1> 
</DIV>

<DIV id=navfirst>
<div id="indexGuide"><UL><li ><A href="../basic/index.html">Android基础</A> </li><li ><A href="../component/index.html">Android组件</A> </li><li ><A href="../userinterface/index.html">用户界面</A> </li><li ><A href="../device/index.html">设备功能</A> </li><li ><A href="../datastorage/index.html">数据存储</A> </li><li ><A href="../network/index.html">网络应用</A> </li><li class="navcurrentLink"><A href="index.html">游戏开发</A> </li><li ><A href="../multimedia/index.html">多媒体</A> </li><li ><A href="../source/index.html">源码开发</A> </li><li ><A href="../advance/index.html">高级进阶</A> </li><li ><A href="../interview/index.html">Android面试题</A> </li></UL></div>
</DIV>
<DIV id=navsecond>
<DIV id=course>
<div id="kcTitle">课 程 表</div>


  <h2><A title="游戏开发须知" href="index_187.html">游戏开发须知</A></h2>

  <h2><A title="游戏策划、设计分析" href="index_188.html">游戏策划、设计分析</A></h2>

  <h2><A title="Android OpenGL学习" href="index_190.html">Android OpenGL学习</A></h2>

  <h2><A title="Android游戏开发之旅" href="index_191.html">Android游戏开发之旅</A></h2>

  <h2><A title="Android2D游戏开发" href="index_192.html">Android2D游戏开发</A></h2>
<UL><li ><A title=【Android2D游戏开发之一】设置全屏以及绘画简单的图形 href="show_501_192.html">【Android2D游戏开发之一】设置全屏以及绘画简单的图形</A> </li><li ><A title=【Android2D游戏开发之二】剖析游戏开发用view还是sarfaceView？ href="show_502_192.html">【Android2D游戏开发之二】剖析游戏开发用view还是sarfaceView？</A> </li><li ><A title=【Android2D游戏开发之三】剖析 SurfaceView ！ Callback以及SurfaceHol href="show_503_192.html">【Android2D游戏开发之三】剖析 SurfaceView ！ Callback以及SurfaceHol</A> </li><li ><A title=【Android2D游戏开发之四】Android 游戏框架（游戏角色行走demo) href="show_504_192.html">【Android2D游戏开发之四】Android 游戏框架（游戏角色行走demo)</A> </li><li ><A title=【Android2D游戏开发之五】游戏注册界面,两个Activity切换交互 href="show_505_192.html">【Android2D游戏开发之五】游戏注册界面,两个Activity切换交互</A> </li><li ><A title=【Android2D游戏开发之六】在SurfaceView中添加组件！并交互数据 href="show_506_192.html">【Android2D游戏开发之六】在SurfaceView中添加组件！并交互数据</A> </li><li ><A title=【Android2D游戏开发之七】游戏开发样式!再剖析SurfaceView组件 href="show_507_192.html">【Android2D游戏开发之七】游戏开发样式!再剖析SurfaceView组件</A> </li><li ><A title=【Android2D游戏开发之八】游戏音频 href="show_508_192.html">【Android2D游戏开发之八】游戏音频</A> </li><li ><A title=【Android2D游戏开发之九】触屏Bug解决方案及禁止横竖屏切换! href="show_509_192.html">【Android2D游戏开发之九】触屏Bug解决方案及禁止横竖屏切换!</A> </li><li ><A title=【Android2D游戏开发之十】详细剖析Android Traceview效率检视工具 href="show_510_192.html">【Android2D游戏开发之十】详细剖析Android Traceview效率检视工具</A> </li><li ><A title=【Android2D游戏开发十一】手把手让你爱上Android “9妹” href="show_511_192.html">【Android2D游戏开发十一】手把手让你爱上Android “9妹”</A> </li><li class="currentLink"><A title=【Android2D游戏开发十二】详解SharedPreference,FIle将数据存到SD卡 href="show_512_192.html">【Android2D游戏开发十二】详解SharedPreference,FIle将数据存到SD卡</A> </li><li ><A title=【Android2D游戏开发十三】详解SQLite，并把数据库文件存SD卡中-2 href="show_513_192.html">【Android2D游戏开发十三】详解SQLite，并把数据库文件存SD卡中-2</A> </li><li ><A title=【Android2D游戏开发十四】在SurfaceView中照样使用Animation(下) href="show_514_192.html">【Android2D游戏开发十四】在SurfaceView中照样使用Animation(下)</A> </li><li ><A title=【Android2D游戏开发十五】游戏触屏事件的性能优化笔记！ href="show_515_192.html">【Android2D游戏开发十五】游戏触屏事件的性能优化笔记！</A> </li><li ><A title=【Android2D游戏开发十六】详解Gesture 手势操作！实现切换图片 href="show_516_192.html">【Android2D游戏开发十六】详解Gesture 手势操作！实现切换图片</A> </li><li ><A title=【Android2D游戏开发十七】输入法手势技术,自定义手势玩游戏 href="show_517_192.html">【Android2D游戏开发十七】输入法手势技术,自定义手势玩游戏</A> </li><li ><A title=【Android2D游戏开发十八】解放手指,利用传感器开发游戏！ href="show_518_192.html">【Android2D游戏开发十八】解放手指,利用传感器开发游戏！</A> </li><li ><A title=【Android2D游戏开发十九】(必看篇)剖析Back与Home键及异常处理 href="show_519_192.html">【Android2D游戏开发十九】(必看篇)剖析Back与Home键及异常处理</A> </li><li ><A title=【Android2D游戏开发二十】物理游戏之重力系统开发 href="show_520_192.html">【Android2D游戏开发二十】物理游戏之重力系统开发</A> </li><li ><A title=【Android2D游戏开发二十一】Android设备谎言分辨率的解决方案 href="show_521_192.html">【Android2D游戏开发二十一】Android设备谎言分辨率的解决方案</A> </li><li ><A title=【Android游戏开发二十二】详解游戏中如何灵活实现动画播放! href="show_522_192.html">【Android游戏开发二十二】详解游戏中如何灵活实现动画播放!</A> </li><li ><A title=【Android游戏开发二十三】自定义【通用】ListView适配器 href="show_523_192.html">【Android游戏开发二十三】自定义【通用】ListView适配器</A> </li><li ><A title=【Android游戏开发二十四】360°平滑游戏摇杆 href="show_524_192.html">【Android游戏开发二十四】360°平滑游戏摇杆</A> </li><li ><A title=【Android游戏开发二十五】Android平台使用《贝赛尔曲线》！ href="show_525_192.html">【Android游戏开发二十五】Android平台使用《贝赛尔曲线》！</A> </li><li ><A title=【Android游戏开发二十六】追加简述SurfaceView 与 GLSurfaceView效 href="show_526_192.html">【Android游戏开发二十六】追加简述SurfaceView 与 GLSurfaceView效</A> </li></UL>
  <h2><A title="Android经典实例教程解析" href="index_193.html">Android经典实例教程解析</A></h2>

  <h2><A title="Android游戏开发实例" href="index_194.html">Android游戏开发实例</A></h2>

  <h2><A title="Libgdx游戏引擎" href="index_195.html">Libgdx游戏引擎</A></h2>

</DIV></DIV>
<DIV id=maincontent>
<DIV id=w3school>
<H1></H1>
<P><STRONG></STRONG></P></DIV>

<DIV>
<H2>【Android2D游戏开发十二】详解SharedPreference,FIle将数据存到SD卡</H2>
<div style="line-height:20px; font-size:14px;"><p>对于游戏中的数据进行保存方式，在Android中常用的有四种保存方式，这里我先给大家统一先简单的介绍下：</p><p>1.SharedPreference</p><p>此保存方式试用于简单数据的保存，文如其名属于配置性质的保存，不适合数据比较大的保存方式；</p><p>2.文件存储 (FIleInputStream/FileOutputStream)</p><p>此保存方式比较适合游戏的保存和使用，可以保存较大的数据，因为相对于SQLite来说更容易让童鞋们接受，此方式不仅能把数据存储在系统中也能将数据保存到SDcard中;</p><p>3.SQLite</p><p>此保存方式比较适合游戏的保存和使用，可以保存较大的数据，并且可以将自己的数据存储到文件系统或者数据库当中，也可以将自己的数据存储到SQLite数据库当中,也能将数据保存到SDcard中;</p><p>4.ContentProvider (不推荐用于游戏保存)</p><p>此保存方式不推荐用于游戏保存，因为此方式不仅能存储较大数据，还支持多个程序之间就的数据进行交换！！！但是由于游戏中基本就不可能去访问外部应用的数据,所以对于此方式我不予讲解， 有兴趣的可以去自行百度 google 学习;</p><p>以上简单的对几种常用的保存方式进行的概述，那么，下面会详细的去分析每个的优缺点以及每种保存的实现和需要注意的地方！</p><p>下面我首先向大家介绍第一种保存方式：</p><p>保存方式之：《SharedPreference》</p><p>优点：简单、方便、适合简单数据的快速保存</p><p>缺点：1.存数的文件只能在同一包内使用，不能在不同包之间使用!</p><p>2.默认将数据存放在系统路径下 /data/data/com.android/  ，没有找到放SD卡上的方法。</p><p>总结：其实本保存方式如同它的名字一样是个配置保存，虽然方便，但只适合存储比较简单的数据!</p><p>下面是SharedPreference 的代码实现和详细讲解:</p><p><pre><font class="Comments">/**</font></p><p> <font class="Comments">* @author android</font></p><p> <font class="Comments">* @保存方式：SharedPreference</font></p><p> <font class="Comments">* @注意：SharedPreference 只能在同一包内使用，不能在不同包之间使用!</font></p><p> <font class="Comments">* @操作模式: Context.MODE_PRIVATE：新内容覆盖原内容 Context.MODE_APPEND：新内容追加到原内容后</font></p><p> <font class="Comments">*        Context.MODE_WORLD_READABLE：允许其他应用程序读取</font></p><p> <font class="Comments">*        Context.MODE_WORLD_WRITEABLE：允许其他应用程序写入，会覆盖原数据。</font></p><p> <font class="Comments">*/</font></p><p><font class="keyword">public </font><font class="keyword">class </font>MainActivity </font><font class="keyword">extends </font>Activity </font><font class="keyword">implements </font>OnClickListener {</p><p>	<font class="keyword">private </font>EditText et_login, et_password;</p><p>	<font class="keyword">private </font>Button btn_save;</p><p>	<font class="keyword">private </font>TextView tv_title;</p><p>	<font class="keyword">private </font>SharedPreferences sp;</p><p>	@Override</p><p>	<font class="keyword">public </font><font class="keyword">void </font>onCreate(Bundle savedInstanceState) {</p><p>		<font class="keyword">super</font>.onCreate(savedInstanceState);</p><p>		getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN,</p><p>				WindowManager.LayoutParams.FLAG_FULLSCREEN);</p><p>		<font class="keyword">this</font>.requestWindowFeature(Window.FEATURE_NO_TITLE);</p><p>		setContentView(R.layout.main);</p><p>		btn_save = (Button) findViewById(R.id.button_save);</p><p>		</font>btn_save.setOnClickListener(<font class="keyword">this</font>);</p><p>		et_login = (EditText) findViewById(R.id.editText_Login);</p><p>		et_password = (EditText) findViewById(R.id.editText_Password);</p><p>		tv_title = (TextView) findViewById(R.id.tv_title);</p><p>		<font class="Comments">// 这里我们先调用 getSharedPreferences()来实例化一个SharedPreferences,</font></p><p>		<font class="Comments">// 第二个参数是指：操作模式(上面对各种操作模式已有解释)</font></p><p>		</font>sp = getSharedPreferences(<font class="Fields">"Setting_android"</font>, MODE_PRIVATE);</p><p>		/*</p><p>		 <font class="Comments">* 下面代码是我们要在程序刚启动的时候我们来读取之前的数据, 当然我们还没有保存任何数据所以肯定找不到！！</font></p><p>		 <font class="Comments">* 如果找不到也没关系会默认返回一个参数值，看下面的方法含义便知！</font></p><p>		 <font class="Comments">*/</font></p><p>		</font>sp.getString(<font class="Fields">"login"</font>, </font><font class="Fields">""</font>);</p><p>		<font class="Comments">// getString()类似哈希表，一个key 一个volue ,</font></p><p>		<font class="Comments">// 这个方法如果找不到对应的第一个参数(key),那么将以第二个参数作为此key的返回值</font></p><p>		</font>et_login.setText(sp.getString(<font class="Fields">"login"</font>, </font><font class="Fields">""</font>));</p><p>		</font>et_password.setText(sp.getString(<font class="Fields">"password"</font>, </font><font class="Fields">""</font>));</p><p>	}</p><p>	@Override</p><p>	<font class="keyword">public </font><font class="keyword">void </font>onClick(View v) {</p><p>		<font class="keyword">if </font>(v == btn_save) {</p><p>			<font class="keyword">if </font>(et_login.getText().toString().equals(<font class="Fields">""</font>))</p><p>				</font>tv_title.setText(<font class="Fields">"请输入帐号!"</font>);</p><p>			<font class="keyword">else </font><font class="keyword">if </font>(et_password.getText().toString().equals(<font class="Fields">""</font>))</p><p>				</font>tv_title.setText(<font class="Fields">"请输入密码!"</font>);</p><p>			<font class="keyword">else </font>{</p><p>				sp.edit()</p><p>						</font>.putString(<font class="Fields">"login"</font>, et_login.getText().toString())</p><p>						</font>.putString(<font class="Fields">"password"</font>, et_password.getText().toString())</p><p>						.commit();</p><p>				<font class="Comments">// 从sp.edit()开始进入编辑状态，直到commit()提交！</font></p><p>				</font>tv_title.setText(<font class="Fields">"保存成功!可重新打开此程序,测试是否已经保存数据!</p><p>						</font>+ <font class="Fields">"\n(或者在</font><font class="Fields">'File Explorer'</font>窗口下-data-data-com.android路径下</p><p>						</font>+ <font class="Fields">"是否存在"</font> + </font><font class="Fields">"了</font><font class="Fields">'Setting_android.xml'</font>)"</font>);</p><p>			}</p><p>		}</p><p>	}</p><p>}</p><p></pre></p><p>代码中的注释的很清楚了，比较简单,不多说了。             </p><p>保存方式之：《文件存储 OutputStream/InputStream》           </p><p>优点： </p><p>1.适合游戏存储，能存储较大数据；  </p><p>2.不仅能存储到系统中，也能存储到SD卡中！           </p><p>总结：如果童鞋们对SQL不太熟习的话那么选择此种方式最为合适的啦。</p><p><pre><font class="Comments">/**</font></p><p> <font class="Comments">* @author android</font></p><p> <font class="Comments">* @保存方式：Stream 数据流方式</font></p><p> <font class="Comments">* @注意1：默认情况下，使用openFileOutput 方法创建的文件只能被其调用的应用使用， 其他应用无法读取这个文件，如果需要在不同的应用中共享数据；</font></p><p> <font class="Comments">* @注意2：因为android os内部闪存有限，所以适合保存较少的数据，当然我们也有解决的方法，</font></p><p> <font class="Comments">*                就是把数据保存在SD开中，这样就可以了，后面我也会向大家讲解 !</font></p><p> <font class="Comments">* @提醒1 调用FileOutputStream 时指定的文件不存在，Android 会自动创建它。 另外，在默认情况下，写入的时候会覆盖原</font></p><p> <font class="Comments">*      文件内容，如果想把新写入的内 容附加到原文件内容后，则可以指定其mode为Context.MODE_APPEND。</font></p><p> <font class="Comments">* @提醒2 启动程序就初始化的时候一定要注意处理！代码中有注释！一定要仔细看！</font></p><p> <font class="Comments">* </font></p><p> <font class="Comments">* @提醒3 这里我给大家讲两种方式，一种是原生态file流来写入/读入, 另外一种是用Data流包装file流进行写入/读入</font></p><p> <font class="Comments">*      其实用data流来包装进行操作; 原因是：包装后支持了更多的写入/读入操作，比如：file流写入不支持 writeUTF(String</font></p><p> <font class="Comments">*      str); 但是用Data包装后就会支持。</font></p><p> <font class="Comments">* @操作模式: Context.MODE_PRIVATE：新内容覆盖原内容 Context.MODE_APPEND：新内容追加到原内容后</font></p><p> <font class="Comments">*        Context.MODE_WORLD_READABLE：允许其他应用程序读取</font></p><p> <font class="Comments">*        Context.MODE_WORLD_WRITEABLE：允许其他应用程序写入，会覆盖原数据。</font></p><p> <font class="Comments">*/</font></p><p><font class="keyword">public </font><font class="keyword">class </font>MainActivity </font><font class="keyword">extends </font>Activity </font><font class="keyword">implements </font>OnClickListener {</p><p>	<font class="keyword">private </font>EditText et_login, et_password;</p><p>	<font class="keyword">private </font>Button btn_save;</p><p>	<font class="keyword">private </font>TextView tv_title;</p><p>	<font class="keyword">private </font>FileOutputStream fos;</p><p>	<font class="keyword">private </font>FileInputStream fis;</p><p>	<font class="keyword">private </font>DataOutputStream dos;</p><p>	<font class="keyword">private </font>DataInputStream dis;</p><p>	@Override</p><p>	<font class="keyword">public </font><font class="keyword">void </font>onCreate(Bundle savedInstanceState) {</p><p>		</font>String temp = <font class="keyword">null</font>;</p><p>		<font class="keyword">super</font>.onCreate(savedInstanceState);</p><p>		getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN,</p><p>				WindowManager.LayoutParams.FLAG_FULLSCREEN);</p><p>		<font class="keyword">this</font>.requestWindowFeature(Window.FEATURE_NO_TITLE);</p><p>		setContentView(R.layout.main);</p><p>		btn_save = (Button) findViewById(R.id.button_save);</p><p>		</font>btn_save.setOnClickListener(<font class="keyword">this</font>);</p><p>		et_login = (EditText) findViewById(R.id.editText_Login);</p><p>		et_password = (EditText) findViewById(R.id.editText_Password);</p><p>		tv_title = (TextView) findViewById(R.id.tv_title);</p><p>		<font class="keyword">try </font>{</p><p>			<font class="Comments">// openFileInput 不像 sharedPreference 中</font></p><p>			<font class="Comments">// getSharedPreferences的方法那样找不到会返回默认值,</font></p><p>			<font class="Comments">// 这里找不到数据文件就会报异常,所以finally里关闭流尤为重要!!!</font></p><p>			<font class="keyword">if </font>(</font><font class="keyword">this</font>.openFileInput(<font class="Fields">"save.android"</font>) != </font><font class="keyword">null</font>) {</p><p>				<font class="Comments">// --------------单纯用file来读入的方式-----------------</font></p><p>				<font class="Comments">// fis = this.openFileInput("save.android");</font></p><p>				<font class="Comments">// ByteArrayOutputStream byteArray = new</font></p><p>				<font class="Comments">// ByteArrayOutputStream();</font></p><p>				<font class="Comments">// byte[] buffer = new byte[1024];</font></p><p>				<font class="Comments">// int len = 0;</font></p><p>				<font class="Comments">// while ((len = fis.read(buffer)) &gt; 0) {</font></p><p>				<font class="Comments">// byteArray.write(buffer, 0, len);</font></p><p>				<font class="Comments">// }</font></p><p>				<font class="Comments">// temp = byteArray.toString();</font></p><p>				<font class="Comments">// -------------- 用data流包装后的读入的方式------------</font></p><p>				</font>fis = <font class="keyword">this</font>.openFileInput(<font class="Fields">"save.android"</font>);<font class="Comments">// 备注1</font></p><p>				</font>dis = <font class="keyword">new </font>DataInputStream(fis);</p><p>				et_login.setText(dis.readUTF());</p><p>				et_password.setText(dis.readUTF());</p><p>				<font class="Comments">// 这里也是在刚启动程序的时候去读入存储的数据</font></p><p>				<font class="Comments">// 读的时候要注意顺序; 例如我们写入数据的时候</font></p><p>				<font class="Comments">// 先写的字符串类型,我们也要先读取字符串类型,一一对应！</font></p><p>			}</p><p>		</font>} <font class="keyword">catch </font>(FileNotFoundException e) {</p><p>			e.printStackTrace();</p><p>		</font>} <font class="keyword">catch </font>(IOException e) {</p><p>			e.printStackTrace();</p><p>		} finally {</p><p>			<font class="Comments">// 在finally中关闭流!因为如果找不到数据就会异常我们也能对其进行关闭操作 ;</font></p><p>			<font class="keyword">try </font>{</p><p>				<font class="keyword">if </font>(</font><font class="keyword">this</font>.openFileInput(<font class="Fields">"save.android"</font>) != </font><font class="keyword">null</font>) {</p><p>					<font class="Comments">// 这里也要判断，因为找不到的情况下，两种流也不会实例化。</font></p><p>					<font class="Comments">// 既然没有实例化，还去调用close关闭它,肯定"空指针"异常！！！</font></p><p>					fis.close();</p><p>				}</p><p>			</font>} <font class="keyword">catch </font>(FileNotFoundException e) {</p><p>				e.printStackTrace();</p><p>			</font>} <font class="keyword">catch </font>(IOException e) {</p><p>				e.printStackTrace();</p><p>			}</p><p>		}</p><p>	}</p><p>	@Override</p><p>	<font class="keyword">public </font><font class="keyword">void </font>onClick(View v) {</p><p>		<font class="keyword">if </font>(Environment.getExternalStorageState() != </font><font class="keyword">null</font>) {</p><p>			<font class="Comments">// 这个方法在试探终端是否有sdcard!</font></p><p>			</font>Log.v(<font class="Fields">"android"</font>, </font><font class="Fields">"有SD卡"</font>);</p><p>		}</p><p>		<font class="keyword">if </font>(v == btn_save) {</p><p>			<font class="keyword">if </font>(et_login.getText().toString().equals(<font class="Fields">""</font>))</p><p>				</font>tv_title.setText(<font class="Fields">"请输入帐号!"</font>);</p><p>			<font class="keyword">else </font><font class="keyword">if </font>(et_password.getText().toString().equals(<font class="Fields">""</font>))</p><p>				</font>tv_title.setText(<font class="Fields">"请输入密码!"</font>);</p><p>			<font class="keyword">else </font>{</p><p>				<font class="keyword">try </font>{</p><p>					<font class="Comments">// ------单纯用file来写入的方式--------------</font></p><p>					<font class="Comments">// fos = new FileOutputStream(f);</font></p><p>					<font class="Comments">// fos.write(et_login.getText().toString().getBytes());</font></p><p>					<font class="Comments">// fos.write(et_password.getText().toString().getBytes());</font></p><p>					<font class="Comments">// ------data包装后来写入的方式--------------</font></p><p>					</font>fos = <font class="keyword">this</font>.openFileOutput(<font class="Fields">"save.android"</font>, MODE_PRIVATE);<font class="Comments">// 备注2</font></p><p>					</font>dos = <font class="keyword">new </font>DataOutputStream(fos);</p><p>					dos.writeUTF(et_login.getText().toString());</p><p>					dos.writeUTF(et_password.getText().toString());</p><p>					</font>tv_title.setText(<font class="Fields">"保存成功!可重新打开此程序,测试是</p><p>							</font>+ <font class="Fields">"否已经保存数据!\n(或者在</font><font class="Fields">'File Explorer</p><p>							</font>+ <font class="Fields">"窗口下-data-data-com.android-files路径下</p><p>							</font>+ <font class="Fields">"是否存在了</font><font class="Fields">'save.android'</font>)"</font>);</p><p>				</font>} <font class="keyword">catch </font>(FileNotFoundException e) {</p><p>					e.printStackTrace();</p><p>				</font>} <font class="keyword">catch </font>(IOException e) {</p><p>					e.printStackTrace();</p><p>				} finally {</p><p>					<font class="Comments">// 在finally中关闭流 这样即使try中有异常我们也能对其进行关闭操作 ;</font></p><p>					<font class="keyword">try </font>{</p><p>						dos.close();</p><p>						fos.close();</p><p>					</font>} <font class="keyword">catch </font>(IOException e) {</p><p>						e.printStackTrace();</p><p>					}</p><p>				}</p><p>			}</p><p>		}</p><p>	}</p><p>}</p><p></pre></p><p>以上代码中实现了两种流形式来完成写入和读入，这里我们为什么要使用Data流来包装，其实不光是获得更多的操作方式，最主要的是方便快捷，你比如用file来读入的时候，明显的复杂了一些不说，它还一次性把所有数据都取出来了，不便于对数据的处理！</p><p>强调的有几点：</p><p>1：在一开始对数据的访问再次提醒童鞋们，这个跟sharedPreference的获取方式不一样，sharedPreference的获取方式可以得到一个默认的值，但是你用咱们获取的是个文件，而且直接就去open这个文件，一旦不存在必定异常，所以这一块的异常处理，以及finally的处理一定要处理得当。</p><p>2.其实在一开始用data包装的时候发现写入的字符串在读入的时候发现字符乱码了，查了api才发现，api规定当写入字符串的时候必须写入UTF-8格式的编码，但是后来不知道怎么了就没事了。所以这里如果童鞋们遇到此问题，我给出大家一个解决方法，就是在写入的时候我们不要去DataOutputStream 来包装而是用，OutputStreamWriter，因为在构造的可以设定编码！  </p><p><pre>                               </p><p>OutputStreamWriter osw = <font class="keyword">new </font>OutputStreamWriter(fis,<font class="Fields">"UTF-8"</font>); </p><p>String  content = EncodingUtils.getString(buffer, <font class="Fields">"UTF-8"</font>);   </p><p></pre></p><p>这个也能把字符数组转码制！这样写入的就肯定是UTF-8编码的字符啦、下面介绍如何把我们的数据通过OutputStream/InputStream存入SD卡中!其实将我们的数据放入SD卡中，无疑就需要对代码进行两处的修改：注意：一定要有SD卡！对于如何创建SD卡在前一篇文章中已经说了两种方式，不会的童鞋可以去看下；</p><p>第一：检查是否装有SD卡；  </p><p>第二： 修改读入的地方(备注1)</p><p><pre>      </p><p>fis=<font class="keyword">this</font>.openFileInput(<font class="Fields">"save.android"</font>);<font class="Comments">//这里没有路径，路径是默认的data-data-com.android-files下替换成我们的SD卡的路径就可以了：</font></p><p>File path = <font class="keyword">new </font>File(<font class="Fields">"/sdcard/android/save.android"</font>);<font class="Comments">//这里新建一个File目录路径          </font></p><p>fis = <font class="keyword">new </font>FileInputStream(path);</p><p></pre></p><p>传入路径第三 : </p><p>修改写入的地方(备注2)fos=this.openFileOutput("save.android",MODE_PRIVATE);这里也是默认路径,需要对其修改,注意：这里修改了，那么在finally中的判定大家也要对应的适当修改；注意：如果是系统路径,当没有此文件的时候,android会默认创建一个！但是我们放入SD卡的时候要自己创建目录路径和文件！</p><p><pre>  </p><p><font class="keyword">if </font>(Environment.getExternalStorageState() != </font><font class="keyword">null</font>) {<font class="Comments">// 这个方法在试探终端是否有sdcard!  </font></p><p>    </font>Log.v(<font class="Fields">"android"</font>, </font><font class="Fields">"有SD卡"</font>);</p><p>    </font>File path = <font class="keyword">new </font>File(<font class="Fields">"/sdcard/android"</font>);<font class="Comments">// 创建目录</font></p><p>    </font>File f = <font class="keyword">new </font>File(<font class="Fields">"/sdcard/android/save.android"</font>);<font class="Comments">// 创建文件</font></p><p>    <font class="keyword">if </font>(!path.exists()) {<font class="Comments">// 目录存在返回</font><font class="keyword">false</font>  </font></p><p>        path.mkdirs();<font class="Comments">// 创建一个目录</font></p><p>    }  </p><p>    <font class="keyword">if </font>(!f.exists()) {<font class="Comments">// 文件存在返回</font><font class="keyword">false</font>  </font></p><p>        f.createNewFile();<font class="Comments">// 创建一个文件</font></p><p>    }  </p><p>    </font>fos = <font class="keyword">new </font>FileOutputStream(f);<font class="Comments">// 将数据存入sd卡中</font></p><p>} </p><p></pre></p><p>第四： 因为我们要在SD卡中进行写入的操作，所以要在配置文件中声明权限！这一句就是啦~    </p><p><pre>     </p><p>&lt;uses-permission android:name=<font class="Fields">"android.permission.WRITE_EXTERNAL_STORAGE"</font>/&gt; </p><p></pre></p><p>为了让大家看到所放的位置，所以把整个xml放出来供参考；那么当创建路径和文件的时候，我们对其检查SD卡中是否已经存在exists（）方法 ，如果已经存在就不去创建，这样避免下次再次写入数据的时候又新建了文件和路径、其实我们在可以在启动程序的时候判断如果没有此文件，我们可以直接紧接着创建一个文件，这些都属于优化上的了，我主要是让大家引入，学会，那么其他的简化啦，优化啦，其他方式去实现啦都留给各位同学自己了、OK、今天就先介绍到这里，后面会单独剖析SQLite如何存入数据，以及对数据操作的！</p><p></p></div>

</DIV></DIV>

<DIV id=footer style="display:none">
<P align="center">  
 
 
 
    </P>
</DIV></BODY></HTML>

