
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML xmlns="http://www.w3.org/1999/xhtml">
<HEAD>
<TITLE>【Android2D游戏开发十七】输入法手势技术,自定义手势玩游戏_Android学习手册</TITLE>
<META content="text/html; charset=gb2312" http-equiv=Content-Type><LINK  rel=stylesheet type=text/css href="../css/c5.css">
<META name=GENERATOR content="MSHTML 8.00.6001.18702">
<meta name="Description" content=Android基础 Android组件 Android用户界面 Android设备功能 Android数据存储 Android网络应用 Android游戏开发 Android多媒体 Android源码开发 Android高级进阶 Android面试题/>
<meta name="Keywords" content="android 学习手册">

</HEAD>
<BODY id=homesecond class=serverscripting>
<DIV id=wrapper>
<DIV id=header><h1><a href="../index.html">Android学习手册</a></h1> 
</DIV>

<DIV id=navfirst>
<div id="indexGuide"><UL><li ><A href="../basic/index.html">Android基础</A> </li><li ><A href="../component/index.html">Android组件</A> </li><li ><A href="../userinterface/index.html">用户界面</A> </li><li ><A href="../device/index.html">设备功能</A> </li><li ><A href="../datastorage/index.html">数据存储</A> </li><li ><A href="../network/index.html">网络应用</A> </li><li class="navcurrentLink"><A href="index.html">游戏开发</A> </li><li ><A href="../multimedia/index.html">多媒体</A> </li><li ><A href="../source/index.html">源码开发</A> </li><li ><A href="../advance/index.html">高级进阶</A> </li><li ><A href="../interview/index.html">Android面试题</A> </li></UL></div>
</DIV>
<DIV id=navsecond>
<DIV id=course>
<div id="kcTitle">课 程 表</div>


  <h2><A title="游戏开发须知" href="index_187.html">游戏开发须知</A></h2>

  <h2><A title="游戏策划、设计分析" href="index_188.html">游戏策划、设计分析</A></h2>

  <h2><A title="Android OpenGL学习" href="index_190.html">Android OpenGL学习</A></h2>

  <h2><A title="Android游戏开发之旅" href="index_191.html">Android游戏开发之旅</A></h2>

  <h2><A title="Android2D游戏开发" href="index_192.html">Android2D游戏开发</A></h2>
<UL><li ><A title=【Android2D游戏开发之一】设置全屏以及绘画简单的图形 href="show_501_192.html">【Android2D游戏开发之一】设置全屏以及绘画简单的图形</A> </li><li ><A title=【Android2D游戏开发之二】剖析游戏开发用view还是sarfaceView？ href="show_502_192.html">【Android2D游戏开发之二】剖析游戏开发用view还是sarfaceView？</A> </li><li ><A title=【Android2D游戏开发之三】剖析 SurfaceView ！ Callback以及SurfaceHol href="show_503_192.html">【Android2D游戏开发之三】剖析 SurfaceView ！ Callback以及SurfaceHol</A> </li><li ><A title=【Android2D游戏开发之四】Android 游戏框架（游戏角色行走demo) href="show_504_192.html">【Android2D游戏开发之四】Android 游戏框架（游戏角色行走demo)</A> </li><li ><A title=【Android2D游戏开发之五】游戏注册界面,两个Activity切换交互 href="show_505_192.html">【Android2D游戏开发之五】游戏注册界面,两个Activity切换交互</A> </li><li ><A title=【Android2D游戏开发之六】在SurfaceView中添加组件！并交互数据 href="show_506_192.html">【Android2D游戏开发之六】在SurfaceView中添加组件！并交互数据</A> </li><li ><A title=【Android2D游戏开发之七】游戏开发样式!再剖析SurfaceView组件 href="show_507_192.html">【Android2D游戏开发之七】游戏开发样式!再剖析SurfaceView组件</A> </li><li ><A title=【Android2D游戏开发之八】游戏音频 href="show_508_192.html">【Android2D游戏开发之八】游戏音频</A> </li><li ><A title=【Android2D游戏开发之九】触屏Bug解决方案及禁止横竖屏切换! href="show_509_192.html">【Android2D游戏开发之九】触屏Bug解决方案及禁止横竖屏切换!</A> </li><li ><A title=【Android2D游戏开发之十】详细剖析Android Traceview效率检视工具 href="show_510_192.html">【Android2D游戏开发之十】详细剖析Android Traceview效率检视工具</A> </li><li ><A title=【Android2D游戏开发十一】手把手让你爱上Android “9妹” href="show_511_192.html">【Android2D游戏开发十一】手把手让你爱上Android “9妹”</A> </li><li ><A title=【Android2D游戏开发十二】详解SharedPreference,FIle将数据存到SD卡 href="show_512_192.html">【Android2D游戏开发十二】详解SharedPreference,FIle将数据存到SD卡</A> </li><li ><A title=【Android2D游戏开发十三】详解SQLite，并把数据库文件存SD卡中-2 href="show_513_192.html">【Android2D游戏开发十三】详解SQLite，并把数据库文件存SD卡中-2</A> </li><li ><A title=【Android2D游戏开发十四】在SurfaceView中照样使用Animation(下) href="show_514_192.html">【Android2D游戏开发十四】在SurfaceView中照样使用Animation(下)</A> </li><li ><A title=【Android2D游戏开发十五】游戏触屏事件的性能优化笔记！ href="show_515_192.html">【Android2D游戏开发十五】游戏触屏事件的性能优化笔记！</A> </li><li ><A title=【Android2D游戏开发十六】详解Gesture 手势操作！实现切换图片 href="show_516_192.html">【Android2D游戏开发十六】详解Gesture 手势操作！实现切换图片</A> </li><li class="currentLink"><A title=【Android2D游戏开发十七】输入法手势技术,自定义手势玩游戏 href="show_517_192.html">【Android2D游戏开发十七】输入法手势技术,自定义手势玩游戏</A> </li><li ><A title=【Android2D游戏开发十八】解放手指,利用传感器开发游戏！ href="show_518_192.html">【Android2D游戏开发十八】解放手指,利用传感器开发游戏！</A> </li><li ><A title=【Android2D游戏开发十九】(必看篇)剖析Back与Home键及异常处理 href="show_519_192.html">【Android2D游戏开发十九】(必看篇)剖析Back与Home键及异常处理</A> </li><li ><A title=【Android2D游戏开发二十】物理游戏之重力系统开发 href="show_520_192.html">【Android2D游戏开发二十】物理游戏之重力系统开发</A> </li><li ><A title=【Android2D游戏开发二十一】Android设备谎言分辨率的解决方案 href="show_521_192.html">【Android2D游戏开发二十一】Android设备谎言分辨率的解决方案</A> </li><li ><A title=【Android游戏开发二十二】详解游戏中如何灵活实现动画播放! href="show_522_192.html">【Android游戏开发二十二】详解游戏中如何灵活实现动画播放!</A> </li><li ><A title=【Android游戏开发二十三】自定义【通用】ListView适配器 href="show_523_192.html">【Android游戏开发二十三】自定义【通用】ListView适配器</A> </li><li ><A title=【Android游戏开发二十四】360°平滑游戏摇杆 href="show_524_192.html">【Android游戏开发二十四】360°平滑游戏摇杆</A> </li><li ><A title=【Android游戏开发二十五】Android平台使用《贝赛尔曲线》！ href="show_525_192.html">【Android游戏开发二十五】Android平台使用《贝赛尔曲线》！</A> </li><li ><A title=【Android游戏开发二十六】追加简述SurfaceView 与 GLSurfaceView效 href="show_526_192.html">【Android游戏开发二十六】追加简述SurfaceView 与 GLSurfaceView效</A> </li></UL>
  <h2><A title="Android经典实例教程解析" href="index_193.html">Android经典实例教程解析</A></h2>

  <h2><A title="Android游戏开发实例" href="index_194.html">Android游戏开发实例</A></h2>

  <h2><A title="Libgdx游戏引擎" href="index_195.html">Libgdx游戏引擎</A></h2>

</DIV></DIV>
<DIV id=maincontent>
<DIV id=w3school>
<H1></H1>
<P><STRONG></STRONG></P></DIV>

<DIV>
<H2>【Android2D游戏开发十七】输入法手势技术,自定义手势玩游戏</H2>
<div style="line-height:20px; font-size:14px;"><p>有童鞋问我为什么不用SDK2.1 ,2.2来进行游戏开发，那我这里稍微说两句：</p><p>1.Android SDK 属于向下兼容！那么低版本可以运行的，高版本基本上更是没问题！（当然每次SDK的更新也会带来新功能，或者修改了一些原来的BUG等等，那么其实对于游戏开发来说，如果你的游戏中不需要更高的SDK版本的支持情况下，完全不必去追求最新的SDK！）</p><p>2.使用低版本进行游戏开发这样能兼顾更多的机型，获取更多的用户！</p><p>3.大家都知道Android SDK每次版本的更新，底层代码也会更健壮和优化了!比如我们公司的网游Android版在G2（SDK1.5）上跑起来稍微有些卡，而在我的手机上（SDK2.2）运行起来流畅的没说的~各种舒坦~~但是这样也会带来一些弊端，比如我们自己游戏如果上来就用高版本SDK进行开发，那么对于性能、内存上到底如何，我们都不会很容易的看出其效果，如果我们用低版本的SDK则会让我们明显的感受到性能到底如何~你想想如果你的游戏在1.5，1.6上跑起来很流畅，那放在更高版本的SDK机器上更是没说的啦~</p><p>总结:游戏开发中，如果你游戏不需要更高的API的支持，那么推荐基于SDK 1.5和1.6来开发！</p><p>在上一篇中我给大家介绍了触摸屏手势操作，但是这种触屏手势的操作比较有局限性；比如我们都知道Android可以利用手势来解锁，比如九宫格形式的，通过自定义的一个单笔画手势可以解开屏幕锁，还可以自定义笔画手势来启动一个应用等，那么这种所谓的笔画手势其实就是今天我要给大家讲解的输入法手势识别技术！这种手势是我们可以自己来自定义，而不像之前的触屏手势操作只是利用Android 对一些触屏动作的封装罢了。下面上几张手机自定义笔划手势解锁的的截图：</p><p><img src="../img/games_2d/17_2dgames.jpg"></p><p><img src="../img/games_2d/17_2dgames2.jpg"></p><p><img src="../img/games_2d/17_2dgames3.jpg"></p><p>最后一张图中最后一个是自定义解锁的输入法手势~</p><p>OK，那么既然利用手势既然能进行解锁等操作，那么我们游戏开发中，更是可以加入这一亮点了，比如在游戏中我画个圆形执行换背景操作，画个X表示退出游戏等等，等等、哈哈 是不是感觉很有意思了？好的，下面就开始进入讲解！首先本篇主要学习三点：     1. 如何创建输入法手势、删除输入法手势、从SD卡中读取出手势文件！     2.当输入法手势创建后，如何来匹配出我们的自定义手势！下面我们来熟习两个类和几个概念：</p><p>1. 什么是 GestureOverlayView ？ 简单点说其实就是一个手写绘图区；</p><p>2. 什么是 GestureLibrary ？这个类是对手势进行保存、删除等操作的，一个存放手势的小仓库！</p><p>3. 笔划是什么，字体笔画？是的，其实就是跟我们写字的笔划一个概念！</p><p>4.什么是笔划类型？   输入法手势操作中，笔划类型有两种；一种是：单一笔划，另外一种是：多笔划    </p><p>所谓单一笔划笔划就是一笔划画出一个手势，从你手指接触屏幕开始到你离开屏幕笔画就会立刻形成一个手势!一气呵成！    而多笔划则是可以在一定紧凑时间内随意几笔划都可!然后超过这个紧凑时间后便会形成一个手势！先出项目截图，简单说下其功能和操作：     </p><p><img src="../img/games_2d/17_2dgames4.jpg"></p><p><img src="../img/games_2d/17_2dgames5.jpg"></p><p>图1界面中分为3块，从上到下依次是：TextView ，EditText，SurfaceView；然后在SurfaceView后面还有一个GestureOverlayView！先看下main.xml:</p><p><pre>&lt;?xml version=<font class="Fields">"1.0"</font> encoding=</font><font class="Fields">"utf-8"</font>?&gt;  </p><p>&lt;LinearLayout xmlns:android=<font class="Fields">"http:<font class="Comments">//schemas.android.com/apk/res/android"</font>  </font></p><p>    </font>android:orientation=<font class="Fields">"vertical"</font> android:layout_width=</font><font class="Fields">"fill_parent"</font></p><p>    </font>android:layout_height=<font class="Fields">"fill_parent"</font>&gt;</p><p>    </font>&lt;TextView android:id=<font class="Fields">"@+id/android_tv"</font> android:layout_width=</font><font class="Fields">"fill_parent"</font></p><p>        </font>android:layout_height=<font class="Fields">"wrap_content"</font> android:text=</font><font class="Fields">"@string/hello"</font></p><p>        </font>android:textSize=<font class="Fields">"15sp"</font> android:textColor=</font><font class="Fields">"</font>FFFFFF00"</font> /&gt;</p><p>    </font>&lt;EditText android:id=<font class="Fields">"@+id/android_edit"</font> android:layout_width=</font><font class="Fields">"fill_parent"</font></p><p>        </font>android:layout_height=<font class="Fields">"wrap_content"</font> /&gt;</p><p>    </font>&lt;RelativeLayout android:layout_width=<font class="Fields">"fill_parent"</font></p><p>        </font>android:layout_height=<font class="Fields">"wrap_content"</font> android:layout_weight=</font><font class="Fields">"1"</font>&gt;</p><p>        </font>&lt;com.android.MySurfaceView android:id=<font class="Fields">"@+id/view3d"</font></p><p>            </font>android:layout_width=<font class="Fields">"fill_parent"</font> android:layout_height=</font><font class="Fields">"fill_parent"</font> /&gt;</p><p>        &lt;android.gesture.GestureOverlayView</p><p>            </font>android:id=<font class="Fields">"@+id/android_gesture"</font> android:layout_width=</font><font class="Fields">"fill_parent"</font></p><p>            </font>android:layout_height=<font class="Fields">"fill_parent"</font> android:layout_weight=</font><font class="Fields">"1.0"</font>/&gt;</p><p>    &lt;/RelativeLayout&gt;</p><p>&lt;/LinearLayout&gt;  </p><p></pre></p><p>xml中注册的有我们自定义的surfaceview，对此不太熟悉可以去看下【Android2D开发之六】,不多解释了。关于GestureOverlayView这里也只是简单的定义了宽高,还有一些重要的属性设置在代码中设置了，当然xml也可以设置的;下面看MainActivity.java</p><p><pre><font class="Comments">/**</font></p><p> <font class="Comments">* @author android</font></p><p> <font class="Comments">* @输入法手势识别</font></p><p> <font class="Comments">* @注意: android.gesture这个类在api-4(SDK1.6)才开始支持的！</font></p><p> <font class="Comments">* @提醒：默认存到SD卡中，所以别忘记在AndroidMainfest.xml加上SD卡读写权限！</font></p><p> <font class="Comments">*/</font></p><p><font class="keyword">public </font><font class="keyword">class </font>MainActivity </font><font class="keyword">extends </font>Activity {</p><p>	<font class="keyword">private </font>GestureOverlayView gov;<font class="Comments">// 创建一个手写绘图区</font></p><p>	<font class="keyword">private </font>Gesture gesture;<font class="Comments">// 手写实例</font></p><p>	<font class="keyword">private </font>GestureLibrary gestureLib;<font class="Comments">// 创建一个手势仓库</font></p><p>	<font class="keyword">private </font>TextView tv;</p><p>	<font class="keyword">private </font>EditText et;</p><p>	<font class="keyword">private </font>String path;<font class="Comments">// 手势文件路径</font></p><p>	<font class="keyword">private </font>File file;<font class="Comments">//</font></p><p>	@Override</p><p>	<font class="keyword">public </font><font class="keyword">void </font>onCreate(Bundle savedInstanceState) {</p><p>		<font class="keyword">super</font>.onCreate(savedInstanceState);</p><p>		<font class="keyword">this</font>.getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN,</p><p>				WindowManager.LayoutParams.FLAG_FULLSCREEN);</p><p>		<font class="keyword">this</font>.requestWindowFeature(Window.FEATURE_NO_TITLE);</p><p>		setContentView(R.layout.main);</p><p>		tv = (TextView) findViewById(R.id.android_tv);</p><p>		et = (EditText) findViewById(R.id.android_edit);</p><p>		gov = (GestureOverlayView) findViewById(R.id.android_gesture);</p><p>		gov.setGestureStrokeType(GestureOverlayView.GESTURE_STROKE_TYPE_MULTIPLE);<font class="Comments">// 设置笔划类型</font></p><p>		<font class="Comments">// GestureOverlayView.GESTURE_STROKE_TYPE_MULTIPLE 设置支持多笔划</font></p><p>		<font class="Comments">// GestureOverlayView.GESTURE_STROKE_TYPE_SINGLE 仅支持单一笔划</font></p><p>		</font>path = <font class="keyword">new </font>File(Environment.getExternalStorageDirectory(), <font class="Fields">"gestures"</font>)</p><p>				.getAbsolutePath();</p><p>		<font class="Comments">// 得到默认路径和文件名/sdcard/gestures</font></p><p>		</font>file = <font class="keyword">new </font>File(path);<font class="Comments">// 实例gestures的文件对象</font></p><p>		gestureLib = GestureLibraries.fromFile(path);<font class="Comments">// 实例手势仓库</font></p><p>		</font>gov.addOnGestureListener(<font class="keyword">new </font>OnGestureListener() { <font class="Comments">// 这里是绑定手写绘图区</font></p><p>			@Override</p><p>			<font class="Comments">// 以下方法是你刚开始画手势的时候触发</font></p><p>			<font class="keyword">public </font><font class="keyword">void </font>onGestureStarted(GestureOverlayView overlay,</p><p>					MotionEvent event) {</p><p>				</font>tv.setText(<font class="Fields">"请您在紧凑的时间内用两笔划来完成一个手势！西西~"</font>);</p><p>			}</p><p>			@Override</p><p>			<font class="Comments">// 以下方法是当手势完整形成的时候触发</font></p><p>			<font class="keyword">public </font><font class="keyword">void </font>onGestureEnded(GestureOverlayView overlay,</p><p>					MotionEvent event) {</p><p>				gesture = overlay.getGesture();<font class="Comments">// 从绘图区取出形成的手势</font></p><p>				<font class="keyword">if </font>(gesture.getStrokesCount() == 2) {<font class="Comments">// 我判定当用户用了两笔划</font></p><p>					<font class="Comments">// (强调：如果一开始设置手势笔画类型是单一笔画，那你这里始终得到的只是1！)</font></p><p>					<font class="keyword">if </font>(event.getAction() == MotionEvent.ACTION_UP) {<font class="Comments">// 判定第两笔划离开屏幕</font></p><p>						<font class="Comments">// if(gesture.getLength()==100){}<font class="Comments">//这里是判定长度达到100像素</font></p><p>						<font class="keyword">if </font>(et.getText().toString().equals(<font class="Fields">""</font>)) {</p><p>							</font>tv.setText(<font class="Fields">"由于您没有输入手势名称，so~保存失败啦~"</font>);</p><p>						</font>} <font class="keyword">else </font>{</p><p>							</font>tv.setText(<font class="Fields">"正在保存手势..."</font>);</p><p>							addGesture(et.getText().toString(), gesture);<font class="Comments">// 我自己写的添加手势函数</font></p><p>						}</p><p>					}</p><p>				</font>} <font class="keyword">else </font>{</p><p>					</font>tv.setText(<font class="Fields">"请您在紧凑的时间内用两笔划来完成一个手势！西西~"</font>);</p><p>				}</p><p>			}</p><p>			@Override</p><p>			<font class="keyword">public </font><font class="keyword">void </font>onGestureCancelled(GestureOverlayView overlay,</p><p>					MotionEvent event) {</p><p>			}</p><p>			@Override</p><p>			<font class="keyword">public </font><font class="keyword">void </font>onGesture(GestureOverlayView overlay, MotionEvent event) {</p><p>			}</p><p>		});</p><p>		<font class="Comments">// ----这里是在程序启动的时候进行遍历所有手势!------</font></p><p>		<font class="keyword">if </font>(!gestureLib.load()) {</p><p>			</font>tv.setText(<font class="Fields">"android提示：手势超过9个我做了删除所有手势的操作，为了界面整洁一些！</p><p>					</font>+ <font class="Fields">" 输入法手势练习~(*^__^*)~ 嘻嘻！\n操作介绍：(画手势我设置必须画两笔划才行哦~)\n1.</p><p>					</font>+ <font class="Fields">"添加手势：先EditText中输入名称，然后在屏幕上画出手势！\n2.匹配手势：</p><p>					</font>+ <font class="Fields">"在EditText输入\"</font>android\</font><font class="Fields">",然后输入手势即可！ "</font>);</p><p>		</font>} <font class="keyword">else </font>{</p><p>			Set&lt;String&gt; set = gestureLib.getGestureEntries();<font class="Comments">// 取出所有手势</font></p><p>			Object ob[] = set.toArray();</p><p>			loadAllGesture(set, ob);</p><p>		}</p><p>	}</p><p>}</p><p></pre></p><p>这个就是MainActivity主要代码了，其中添加手势、匹配手势、遍历手势、将手势转成图片这些我都单独写成了函数，这样让各位童鞋更清晰思路一些。从以上代码中我们看出在创建手势之前，手写绘图区（GestureOverlayView）肯定先被创建出来，然后我们就可以在其区域中进行笔划绘画手势了，当然绘画手势前，我们也需要设置了笔划类型，也就是我一开始给大家介绍的~其后最重要的就是手写绘图区的手势监听器绑定，增加OnGestureListener这个监听器重写了四个函数，这里最重要的就两个函数：onGestureStarted 和onGestureEnded； 手势开始和手势结束的监听函数!尤其是手势结束监听这个函数尤为重要，在其中我设置好几个条件语句，这么几个条件一方面是让大家了解Gesture中一些比较重要常用的方法，另一方面我要提醒各位童鞋：如果你设置笔划类型是多笔划类型的，那么理想状态下，应该是在一段紧凑时间内，不管你使用了几笔划来绘制手势，系统都应该在判定你在一定短暂时间内没有再进行笔划的时候才应该创建手势，并且系统响应此函数；      其实错了，一开始我也这么想，但是发现，不管你设置的笔划类型是单一的还是多笔划当你手指离开屏幕，不管你当前是第几笔，Android都会去响应这个完成函数，我在这里调用手势Gesture类中的getStrokesCount（）函数，这个函数会记录在紧凑时间内你绘制手势的笔划数，那么根据这个函数我们就可以解决手指离开屏幕总被响应的问题了，因为单一笔划类型永远这个值不会大于1！而 if (event.getAction() == MotionEvent.ACTION_UP) ｛｝写这个只是给大家演示第二个参数按键动作该怎么用；那么我们下面就来看如何创建一个手势：</p><p><pre><font class="keyword">public </font><font class="keyword">void </font>addMyGesture(String name, Gesture gesture) {</p><p>	<font class="keyword">try </font>{</p><p>		<font class="keyword">if </font>(name.equals(<font class="Fields">"android"</font>)) {</p><p>			findGesture(gesture);</p><p>		</font>} <font class="keyword">else </font>{</p><p>			<font class="Comments">// 关于两种方式创建模拟器的SDcard在【Android2D游戏开发之十】有详解</font></p><p>			<font class="keyword">if </font>(Environment.getExternalStorageState() != </font><font class="keyword">null</font>) {<font class="Comments">// 这个方法在试探终端是否有sdcard!</font></p><p>				<font class="keyword">if </font>(!file.exists()) {<font class="Comments">// 判定是否已经存在手势文件</font></p><p>					<font class="Comments">// 不存在文件的时候我们去直接把我们的手势文件存入</font></p><p>					gestureLib.addGesture(name, gesture);</p><p>					<font class="keyword">if </font>(gestureLib.save()) {<font class="Comments">// <font class="Comments">//保存到文件中</font></p><p>						</font>gov.clear(<font class="keyword">true</font>);<font class="Comments">// 清除笔画</font></p><p>						<font class="Comments">// 注意保存的路径默认是/sdcard/gesture</font></p><p>						<font class="Comments">// ,so~别忘记AndroidMainfest.xml加上读写权限！</font></p><p>						<font class="Comments">// 这里抱怨一下，咳咳、其实昨天就应该出这篇博文的，就是因为这里总是异常,今天仔细看了</font></p><p>						<font class="Comments">// 才发现不是没写权限,而是我虽然在AndroidMainfest.xml中写了权限，但是写错了位置..哭死！</font></p><p>						</font>tv.setText(<font class="Fields">"保存手势成功！因为不存在手势文件，"</font> + </font><font class="Fields">"所以第一次保存手势成功会默认先创</p><p>								</font>+ <font class="Fields">"建了一个手势文件！然后将手势保存到文件中."</font>);</p><p>						</font>et.setText(<font class="Fields">""</font>);</p><p>						gestureToImage(gesture);</p><p>					</font>} <font class="keyword">else </font>{</p><p>						</font>tv.setText(<font class="Fields">"保存手势失败！"</font>);</p><p>					}</p><p>				</font>} <font class="keyword">else </font>{<font class="Comments">// 当存在此文件的时候我们需要先删除此手势然后把新的手势放上</font></p><p>					<font class="Comments">// 读取已经存在的文件,得到文件中的所有手势</font></p><p>					<font class="keyword">if </font>(!gestureLib.load()) {<font class="Comments">// 如果读取失败</font></p><p>						</font>tv.setText(<font class="Fields">"手势文件读取失败！"</font>);</p><p>					</font>} <font class="keyword">else </font>{<font class="Comments">// 读取成功</font></p><p>						Set&lt;String&gt; set = gestureLib.getGestureEntries();<font class="Comments">// 取出所有手势</font></p><p>						Object ob[] = set.toArray();</p><p>						<font class="keyword">boolean </font>isHavedGesture = </font><font class="keyword">false</font>;</p><p>						<font class="keyword">for </font>(</font><font class="keyword">int </font>i = 0; i &lt; ob.length; i++) {<font class="Comments">// 这里是遍历所有手势的name</font></p><p>							<font class="keyword">if </font>(((String) ob[i]).equals(name)) {<font class="Comments">// 和我们新添的手势name做对比</font></p><p>								</font>isHavedGesture = <font class="keyword">true</font>;</p><p>							}</p><p>						}</p><p>						<font class="keyword">if </font>(isHavedGesture) {<font class="Comments">// 如果此变量为</font><font class="keyword">true</font>说明有相同name的手势</font></p><p>							<font class="Comments">// ----备注1-------------------<font class="Comments">//gestureLib.removeGesture(name,</font></p><p>							<font class="Comments">// gesture);<font class="Comments">//删除与当前名字相同的手势</font></p><p>							/*----备注2-----------------*/</p><p>							gestureLib.removeEntry(name);</p><p>							gestureLib.addGesture(name, gesture);</p><p>						</font>} <font class="keyword">else </font>{</p><p>							gestureLib.addGesture(name, gesture);</p><p>						}</p><p>						<font class="keyword">if </font>(gestureLib.save()) {</p><p>							</font>gov.clear(<font class="keyword">true</font>);<font class="Comments">// 清除笔画</font></p><p>							gestureToImage(gesture);</p><p>							</font>tv.setText(<font class="Fields">"保存手势成功！当前所有手势一共有："</font> + ob.length</p><p>									</font>+ <font class="Fields">"个"</font>);</p><p>							</font>et.setText(<font class="Fields">""</font>);</p><p>						</font>} <font class="keyword">else </font>{</p><p>							</font>tv.setText(<font class="Fields">"保存手势失败！"</font>);</p><p>						}</p><p>						<font class="Comments">// <font class="Comments">//------- --以下代码是当手势超过9个就全部清空 操作--------</font></p><p>						<font class="keyword">if </font>(ob.length &gt; 9) {</p><p>							<font class="keyword">for </font>(</font><font class="keyword">int </font>i = 0; i &lt; ob.length; i++) {<font class="Comments">// 这里是遍历删除手势</font></p><p>								gestureLib.removeEntry((String) ob[i]);</p><p>							}</p><p>							gestureLib.save();</p><p>							<font class="keyword">if </font>(MySurfaceView.vec_bmp != </font><font class="keyword">null</font>) {</p><p>								MySurfaceView.vec_bmp.removeAllElements();<font class="Comments">// 删除放置手势图的容器</font></p><p>							}</p><p>							</font>tv.setText(<font class="Fields">"手势超过9个，已全部清空!"</font>);</p><p>							</font>et.setText(<font class="Fields">""</font>);</p><p>						}</p><p>						</font>ob = <font class="keyword">null</font>;</p><p>						</font>set = <font class="keyword">null</font>;</p><p>					}</p><p>				}</p><p>			</font>} <font class="keyword">else </font>{</p><p>				</font>tv.setText(<font class="Fields">"当前模拟器没有SD卡 - -。"</font>);</p><p>			}</p><p>		}</p><p>	</font>} <font class="keyword">catch </font>(Exception e) {</p><p>		</font>tv.setText(<font class="Fields">"操作异常！"</font>);</p><p>	}</p><p>}</p><p></pre></p><p></p></div>

</DIV></DIV>

<DIV id=footer style="display:none">
<P align="center">  
 
 
 
    </P>
</DIV></BODY></HTML>

