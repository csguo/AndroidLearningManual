
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML xmlns="http://www.w3.org/1999/xhtml">
<HEAD>
<TITLE>制作自定义背景Button按钮、自定义形状Button的全攻略_Android学习手册</TITLE>
<META content="text/html; charset=gb2312" http-equiv=Content-Type><LINK  rel=stylesheet type=text/css href="../css/c5.css">
<META name=GENERATOR content="MSHTML 8.00.6001.18702">
<meta name="Description" content=Android基础 Android组件 Android用户界面 Android设备功能 Android数据存储 Android网络应用 Android游戏开发 Android多媒体 Android源码开发 Android高级进阶 Android面试题/>
<meta name="Keywords" content="android 学习手册">

</HEAD>
<BODY id=homesecond class=serverscripting>
<DIV id=wrapper>
<DIV id=header><h1><a href="../index.html">Android学习手册</a></h1> 
</DIV>

<DIV id=navfirst>
<div id="indexGuide"><UL><li ><A href="../basic/index.html">Android基础</A> </li><li ><A href="../component/index.html">Android组件</A> </li><li class="navcurrentLink"><A href="index.html">用户界面</A> </li><li ><A href="../device/index.html">设备功能</A> </li><li ><A href="../datastorage/index.html">数据存储</A> </li><li ><A href="../network/index.html">网络应用</A> </li><li ><A href="../game/index.html">游戏开发</A> </li><li ><A href="../multimedia/index.html">多媒体</A> </li><li ><A href="../source/index.html">源码开发</A> </li><li ><A href="../advance/index.html">高级进阶</A> </li><li ><A href="../interview/index.html">Android面试题</A> </li></UL></div>
</DIV>
<DIV id=navsecond>
<DIV id=course>
<div id="kcTitle">课 程 表</div>


  <h2><A title="用户界面之view(视图)" href="index_123.html">用户界面之view(视图)</A></h2>

  <h2><A title="用户界面之Layout(布局)" href="index_124.html">用户界面之Layout(布局)</A></h2>

  <h2><A title="用户界面之TextView(文本视图)" href="index_125.html">用户界面之TextView(文本视图)</A></h2>

  <h2><A title="用户界面之EditText(编辑视图)" href="index_126.html">用户界面之EditText(编辑视图)</A></h2>

  <h2><A title="用户界面之Button(按钮)" href="index_127.html">用户界面之Button(按钮)</A></h2>
<UL><li ><A title=Android 基本按钮 href="show_401_127.html">Android 基本按钮</A> </li><li ><A title=Android ImageButton(带图标的按钮) href="show_402_127.html">Android ImageButton(带图标的按钮)</A> </li><li ><A title=Android 长按button事件 href="show_403_127.html">Android 长按button事件</A> </li><li ><A title=利用Java反射技术阻止通过按钮关闭对话框（一） href="show_404_127.html">利用Java反射技术阻止通过按钮关闭对话框（一）</A> </li><li ><A title=利用Java反射技术阻止通过按钮关闭对话框（二） href="show_405_127.html">利用Java反射技术阻止通过按钮关闭对话框（二）</A> </li><li ><A title=利用Java反射技术阻止通过按钮关闭对话框（三） href="show_406_127.html">利用Java反射技术阻止通过按钮关闭对话框（三）</A> </li><li class="currentLink"><A title=制作自定义背景Button按钮、自定义形状Button的全攻略 href="show_407_127.html">制作自定义背景Button按钮、自定义形状Button的全攻略</A> </li><li ><A title=Android Button有按下效果 href="show_408_127.html">Android Button有按下效果</A> </li><li ><A title=拖动Button显示效果（完善版） href="show_409_127.html">拖动Button显示效果（完善版）</A> </li><li ><A title=自制含滚动和左右按钮的导航控件 href="show_410_127.html">自制含滚动和左右按钮的导航控件</A> </li><li ><A title=Android 矩形按钮 href="show_411_127.html">Android 矩形按钮</A> </li><li ><A title=Android控件之ZoomButton缩放按钮 href="show_412_127.html">Android控件之ZoomButton缩放按钮</A> </li><li ><A title=Android Button美化实例 href="show_413_127.html">Android Button美化实例</A> </li></UL>
  <h2><A title="用户界面之Dialog(对话框)" href="index_128.html">用户界面之Dialog(对话框)</A></h2>

  <h2><A title="用户界面之ListView(列表视图)" href="index_129.html">用户界面之ListView(列表视图)</A></h2>

  <h2><A title="用户界面之Adapter(适配器)" href="index_130.html">用户界面之Adapter(适配器)</A></h2>

  <h2><A title="用户界面之Menu(菜单)" href="index_131.html">用户界面之Menu(菜单)</A></h2>

  <h2><A title="用户界面之Notification(通知栏)" href="index_132.html">用户界面之Notification(通知栏)</A></h2>

  <h2><A title="NotificationImageView(图像视图)" href="index_133.html">NotificationImageView(图像视图)</A></h2>

  <h2><A title="用户界面之GridView(格视图)" href="index_134.html">用户界面之GridView(格视图)</A></h2>

  <h2><A title="用户界面之ProgressBar(进度条)" href="index_135.html">用户界面之ProgressBar(进度条)</A></h2>

  <h2><A title="用户界面之Checkbox(复选框)" href="index_136.html">用户界面之Checkbox(复选框)</A></h2>

  <h2><A title="用户界面之ScrollView(滚动视图)" href="index_137.html">用户界面之ScrollView(滚动视图)</A></h2>

  <h2><A title="用户界面之Gallery(长廊视图)" href="index_138.html">用户界面之Gallery(长廊视图)</A></h2>

  <h2><A title="用户界面之ActionBar(导航栏)" href="index_139.html">用户界面之ActionBar(导航栏)</A></h2>

  <h2><A title="用户界面之PopupWindow(弹出窗口)" href="index_140.html">用户界面之PopupWindow(弹出窗口)</A></h2>

  <h2><A title="用户界面之RatingBar(评分栏)" href="index_141.html">用户界面之RatingBar(评分栏)</A></h2>

  <h2><A title="用户界面之Spinner" href="index_142.html">用户界面之Spinner</A></h2>

  <h2><A title="用户界面之SeekBar(搜索bar)" href="index_143.html">用户界面之SeekBar(搜索bar)</A></h2>

  <h2><A title="用户界面之TabHost(分割栏)" href="index_144.html">用户界面之TabHost(分割栏)</A></h2>

  <h2><A title="用户界面之SlidingDrawer(抽屉)" href="index_145.html">用户界面之SlidingDrawer(抽屉)</A></h2>

  <h2><A title="用户界面之ViewFlipper" href="index_146.html">用户界面之ViewFlipper</A></h2>

  <h2><A title="用户界面之SurfaceView" href="index_147.html">用户界面之SurfaceView</A></h2>

  <h2><A title="用户界面之Splash" href="index_148.html">用户界面之Splash</A></h2>

  <h2><A title="用户界面之Toast" href="index_149.html">用户界面之Toast</A></h2>

  <h2><A title="用户界面之AlarmManager" href="index_150.html">用户界面之AlarmManager</A></h2>

  <h2><A title="用户界面之Fragment" href="index_151.html">用户界面之Fragment</A></h2>

  <h2><A title="用户界面之WebView(网络视图)" href="index_152.html">用户界面之WebView(网络视图)</A></h2>

  <h2><A title="Android用户界面之Widget(小组件)" href="index_153.html">Android用户界面之Widget(小组件)</A></h2>

  <h2><A title="Android用户界面之theme和style" href="index_154.html">Android用户界面之theme和style</A></h2>

  <h2><A title="Android用户界面之多语言" href="index_155.html">Android用户界面之多语言</A></h2>

  <h2><A title="Android用户界面之界面特效" href="index_156.html">Android用户界面之界面特效</A></h2>

</DIV></DIV>
<DIV id=maincontent>
<DIV id=w3school>
<H1></H1>
<P><STRONG></STRONG></P></DIV>

<DIV>
<H2>制作自定义背景Button按钮、自定义形状Button的全攻略</H2>
<div style="line-height:20px; font-size:14px;"><p>在Android开发应用中，默认的Button是由系统渲染和管理大小的。而我们看到的成功的移动应用，都是有着酷炫的外观和使用体验的。因此，我们在开发产品的时候，需要对默认按钮进行美化。在本篇里，笔者结合在应用开发中的经验，探讨一下自定义背景的按钮、自定义形状按钮的实现方法。</p><p>首先看实现效果截图：</p><p><img src="../img/view_button/07_button.gif"></p><p>自定义背景的按钮目前有2种方式实现，矢量和位图。</p><p>1. 矢量图形绘制的方式</p><p>矢量图形绘制的方式实现简单，适合对于按钮形状和图案要求不高的场合。步骤如下：</p><p>(a) 使用xml定义一个圆角矩形，外围轮廓线实线、内填充渐变色，xml代码如下。</p><p><pre><font class="Comments">//bg_alibuybutton_default.xml  </font></p><p>&lt;?xml version=<font class="Fields">"1.0"</font> encoding=</font><font class="Fields">"utf-8"</font>?&gt;  </p><p>&lt;layer-list xmlns:android=<font class="Fields">"http:<font class="Comments">//schemas.android.com/apk/res/android"</font>&gt;  </font></p><p>   &lt;item&gt;</p><p>      </font>&lt;shape android:shape=<font class="Fields">"rectangle"</font>&gt;</p><p>         </font>&lt;solid android:color=<font class="Fields">"</font>FFEC7600"</font> /&gt;</p><p>         &lt;corners</p><p>            </font>android:topLeftRadius=<font class="Fields">"5dip"</font></p><p>            </font>android:topRightRadius=<font class="Fields">"5dip"</font></p><p>            </font>android:bottomLeftRadius=<font class="Fields">"5dip"</font></p><p>            </font>android:bottomRightRadius=<font class="Fields">"5dip"</font> /&gt;</p><p>      &lt;/shape&gt;</p><p>   &lt;/item&gt;</p><p>   </font>&lt;item android:top=<font class="Fields">"1px"</font> android:bottom=</font><font class="Fields">"1px"</font> android:left=</font><font class="Fields">"1px"</font> android:right=</font><font class="Fields">"1px"</font>&gt;</p><p>     &lt;shape&gt;</p><p>        &lt;gradient</p><p>            </font>android:startColor=<font class="Fields">"</font>FFEC7600"</font> android:endColor=</font><font class="Fields">"</font>FFFED69E"</font></p><p>            </font>android:type=<font class="Fields">"linear"</font> android:angle=</font><font class="Fields">"90"</font></p><p>            </font>android:centerX=<font class="Fields">"0.5"</font> android:centerY=</font><font class="Fields">"0.5"</font> /&gt;</p><p>        &lt;corners</p><p>            </font>android:topLeftRadius=<font class="Fields">"5dip"</font></p><p>            </font>android:topRightRadius=<font class="Fields">"5dip"</font></p><p>            </font>android:bottomLeftRadius=<font class="Fields">"5dip"</font></p><p>            </font>android:bottomRightRadius=<font class="Fields">"5dip"</font> /&gt;</p><p>      &lt;/shape&gt;</p><p>   &lt;/item&gt;</p><p>&lt;/layer-list&gt; </p><p></pre> </p><p>同样定义bg_alibuybutton_pressed.xml和bg_alibuybutton_selected.xml，内容相同，就是渐变颜色不同，用于按钮按下后的背景变化效果。</p><p>(b) 定义按钮按下后的效果变化描述文件drawable/bg_alibuybutton.xml，代码如下。</p><p><pre>&lt;?xml version=<font class="Fields">"1.0"</font> encoding=</font><font class="Fields">"UTF-8"</font>?&gt;  </p><p>&lt;selector xmlns:android=<font class="Fields">"http:<font class="Comments">//schemas.android.com/apk/res/android"</font>&gt;  </font></p><p>    </font>&lt;item android:state_pressed=<font class="Fields">"<font class="keyword">true</font>"</font></p><p>        </font>android:drawable=<font class="Fields">"@drawable/bg_alibuybutton_pressed"</font> /&gt;</p><p>    </font>&lt;item android:state_focused=<font class="Fields">"<font class="keyword">true</font>"</font></p><p>        </font>android:drawable=<font class="Fields">"@drawable/bg_alibuybutton_selected"</font> /&gt;</p><p>    </font>&lt;item android:drawable=<font class="Fields">"@drawable/bg_alibuybutton_default"</font> /&gt;</p><p>&lt;/selector&gt; </p><p></pre> </p><p>(c) 在你需要的界面定义文件中，如layout/main.xml中定义一个Button控件。</p><p><pre>&lt;Button  </p><p>    </font>android:layout_width=<font class="Fields">"120dip"</font></p><p>    </font>android:layout_height=<font class="Fields">"40dip"</font></p><p>    </font>android:text=<font class="Fields">"矢量背景按钮"</font></p><p>	</font>android:background=<font class="Fields">"@drawable/bg_alibuybutton"</font> /&gt;</p><p></pre></p><p>这样，自定义背景的按钮就可以使用了，在实现onClick方法后就可以响应操作。</p><p>2.9-patch图片背景方式</p><p>此种方法相对复杂繁琐，但可以制作出更多、更复杂样式的按钮图样。</p><p>什么是9-patch格式呢？</p><p>9-patch格式，是在Android中特有的一种PNG图片格式，以"***.9.png"结尾。此种格式的图片定义了可以伸缩拉伸的区域和文字显示区域，这样，就可以在Android开发中对非矢量图进行拉伸而仍然保持美观。如果使用位图而没有经过9-patch处理的话，效果就会想第一张截图中的“普通图片背景按钮”那样被无情的拉伸，影响效果。Android中大量用了这种技术，默认的按钮的背景就是用了类似的方法实现的。我们看一下google官方的描述：</p><p><img src="../img/view_button/07_button2.gif"></p><p>该格式相对于一般PNG图片来说，多了上下左右各一条1px的黑线。左、上黑线隔开了9个格子，当中一个格子(见上图Strechable Area区域)声明为可以进行拉伸。右、下两条黑线所定义的Paddingbox区域是在该图片当做背景时，能够在图片上填写文字的区域。每条黑线都是可以不连续的，这样就可以定义出很多自动拉伸的规格。Android sdk中提供了设置的工具，启动命令位于：$ANDROID_SDK/tools/draw9patch.bat，使用它对于原始PNG进行设置9-patch格式，非常方便，如下图：</p><p><img src="../img/view_button/07_button3.jpg"></p><p><img src="../img/view_button/07_button4.jpg">   </p><p>draw9patch工具的右侧是能够看到各方向拉伸后的效果图，你所要做的就是在图上最外侧一圈1px宽的像素上涂黑线。</p><p>注意，在draw9patch.bat第一次运行时，sdk2.2版本上会报错：java.lang.NoClassDefFoundError:org/jdesktop/swingworker/SwingWorker。需要下载swing-worker-1.1.jar，放入$android_sdk/tools/lib路径下，成功运行。</p><p>此种方法实现的步骤如下。</p><p>(a) 使用draw9patch.bat作完图片后，得到两张按钮背景，分别是正常和按下状态下的，命名为bg_btn.9.png和bg_btn_2.9.png。</p><p>(b) 编写图片使用描述文件bg_9patchbutton.xml。</p><p><pre><font class="Comments">// in bg_9patchbutton.xml  </font></p><p>&lt;?xml version=<font class="Fields">"1.0"</font> encoding=</font><font class="Fields">"UTF-8"</font>?&gt;  </p><p>&lt;selector xmlns:android=<font class="Fields">"http:<font class="Comments">//schemas.android.com/apk/res/android"</font>&gt;  </font></p><p>    </font>&lt;item android:state_pressed=<font class="Fields">"<font class="keyword">true</font>"</font></p><p>        </font>android:drawable=<font class="Fields">"@drawable/bg_btn_2"</font> /&gt;</p><p>    </font>&lt;item android:state_focused=<font class="Fields">"<font class="keyword">true</font>"</font></p><p>        </font>android:drawable=<font class="Fields">"@drawable/bg_btn_2"</font> /&gt;</p><p>    </font>&lt;item android:drawable=<font class="Fields">"@drawable/bg_btn"</font> /&gt;</p><p>&lt;/selector&gt;  </p><p></pre></p><p>(c) 在界面定义文件 layout/main.xml中添加Button、ImageButton按钮控件的定义。Button、ImageButton都是可以使用背景属性的。</p><p><pre>&lt;Button  </p><p>    </font>android:layout_width=<font class="Fields">"120dip"</font></p><p>    </font>android:layout_height=<font class="Fields">"40dip"</font></p><p>    </font>android:text=<font class="Fields">"9-patch?????????"</font></p><p>    </font>android:background=<font class="Fields">"@drawable/bg_9patchbutton"</font> /&gt;</p><p>&lt;Button  </p><p>    </font>android:layout_width=<font class="Fields">"200dip"</font></p><p>    </font>android:layout_height=<font class="Fields">"40dip"</font></p><p>    </font>android:text=<font class="Fields">"9-patch?????????"</font></p><p>    </font>android:background=<font class="Fields">"@drawable/bg_9patchbutton"</font> /&gt;</p><p>&lt;Button  </p><p>    </font>android:layout_width=<font class="Fields">"120dip"</font></p><p>    </font>android:layout_height=<font class="Fields">"80dip"</font></p><p>    </font>android:text=<font class="Fields">"9-patch?????????"</font></p><p>    </font>android:background=<font class="Fields">"@drawable/bg_9patchbutton"</font> /&gt;</p><p>&lt;ImageButton  </p><p>    </font>android:layout_width=<font class="Fields">"120dip"</font></p><p>    </font>android:layout_height=<font class="Fields">"40dip"</font></p><p>    </font>android:src=<font class="Fields">"@drawable/bg_9patchbutton"</font></p><p>    </font>android:scaleType=<font class="Fields">"fitXY"</font></p><p>    </font>android:background=<font class="Fields">"@android:color/transparent"</font> /&gt;</p><p></pre> </p><p>以上2种实现按钮的美化，都是标准的矩形按钮为基础。在一些应用中我们可以看到漂亮的自定义形状的异形按钮，这是怎么实现的呢？经过一番研究和实践，找出了一种方便的方法，就是使用ImageButton加上9-patch就可以实现漂亮的自动延伸效果。</p><p>3. 自定义形状、颜色、图样的按钮的实现</p><p>步骤如下。</p><p>(a) 设计一张自定义形状风格背景的图片，如下图。</p><p><img src="../img/view_button/07_button5.gif"></p><p>(b) 未点击和按下后的状态各做一张，形成一套图片，如下图。</p><p><img src="../img/view_button/07_button6.gif"></p><p>forward.png    </p><p><img src="../img/view_button/07_button7.gif"></p><p>forward2.png</p><p>(c) 创建和编写按钮不同状态的图片使用描述文件drawable/ib_forward.xml</p><p><pre><font class="Comments">// ib_forward.xml  </font></p><p>&lt;?xml version=<font class="Fields">"1.0"</font> encoding=</font><font class="Fields">"UTF-8"</font>?&gt;  </p><p>&lt;selector xmlns:android=<font class="Fields">"http:<font class="Comments">//schemas.android.com/apk/res/android"</font>&gt;  </font></p><p>    </font>&lt;item android:state_pressed=<font class="Fields">"<font class="keyword">true</font>"</font></p><p>        </font>android:drawable=<font class="Fields">"@drawable/forward2"</font> /&gt;</p><p>    </font>&lt;item android:state_focused=<font class="Fields">"<font class="keyword">true</font>"</font></p><p>        </font>android:drawable=<font class="Fields">"@drawable/forward2"</font> /&gt;</p><p>    </font>&lt;item android:drawable=<font class="Fields">"@drawable/forward"</font> /&gt;</p><p>&lt;/selector&gt; </p><p></pre> </p><p>(d) 在界面定义文件 layout/main.xml中添加ImageButton按钮控件的定义。</p><p><pre><font class="Comments">// in layout/main.xml  </font></p><p>&lt;ImageButton  </p><p>	</font>android:layout_width=<font class="Fields">"80dip"</font></p><p>	</font>android:layout_height=<font class="Fields">"40dip"</font></p><p>	</font>android:src=<font class="Fields">"@drawable/ib_forword"</font></p><p>	</font>android:scaleType=<font class="Fields">"fitXY"</font></p><p>	</font>android:background=<font class="Fields">"@android:color/transparent"</font> /&gt;</p><p></pre></p><p></p></div>

</DIV></DIV>

<DIV id=footer style="display:none">
<P align="center">  
 
  
   </P>
</DIV></BODY></HTML>

